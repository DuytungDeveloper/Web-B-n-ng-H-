function updateWardSelect(){$.ajax({method:"get",url:"/api/ward/all",success:n=>{var t,i;if(n.success==!0)for(console.log(n),t=0;t<n.data;t++){let r=n.data[t];i=new Option(r.name,r.id);$(i).html(r.name);$("#deliveryWard").append(i)}},error:n=>{console.log(n)}})}function deliveryCityChange(){let n=$("#deliveryCity").val();$.ajax({method:"get",url:"/api/city/district",data:{id:n},success:n=>{var t,i;if(n.success==!0){let r=[];for(t=0;t<n.data.length;t++){let u=n.data[t];i=new Option(u.name,u.id);$(i).html(u.name);r.push(i)}r.length==0&&$("#deliveryWard").empty();$("#deliveryDistrict").empty().append(r);$("#deliveryDistrict").val($("#deliveryDistrict option:first").val()).trigger("change")}},error:n=>{console.log(n)}})}function deliveryDistrictChange(){let n=$("#deliveryDistrict").val();$.ajax({method:"get",url:"/api/district/ward",data:{id:n},success:n=>{var t,i;if(n.success==!0){let r=[];for(t=0;t<n.data.length;t++){let u=n.data[t];i=new Option(u.name,u.id);$(i).html(u.name);r.push(i)}$("#deliveryWard").empty().append(r);$("#deliveryWard").val($("#deliveryWard option:first").val()).trigger("change")}},error:n=>{console.log(n)}})}function tangSoLuongSanPham(n,t,i){let r=getCart();for(var u=0;u<r.length;u++)r[u].id==n&&(r[u].qty=i?r[u].qty+1:r[u].qty-1,r[u].qty<=0&&(r[u].qty=1),$("#product-qty-"+n).val(r[u].qty),$("#price-total-"+n).html(intToPrice(r[u].qty*parseInt(t))));r=r.filter(n=>n.qty>0);editedCart=!0;setCart(r);refreshCart()}let editedCart=!1;$(document).ready(function(){let n=$("#smartwizard").smartWizard({justified:!0,lang:{next:"Tiếp",previous:"Quay lại"},toolbarSettings:{toolbarPosition:"both",toolbarButtonPosition:"center"}});n.on("leaveStep",function(n,t,i,r){var f,u;console.log(`stepIndex : ${i}, stepDirection : ${r}`);let e=getCart();if(editedCart&&location.reload(),r=="backward")return console.log("1"),!0;if(console.log(parseInt(i)==1&&r!="backward"),parseInt(i)==1&&r!="backward"){console.log("2");let t=$("#deliveryForm").serializeArray(),n=!0;return t.forEach(t=>{$(`#${t.name}`).parent().removeClass("has-error");switch(t.name){case"customerName":t.value==""&&($(`#${t.name}`).parent().addClass("has-error"),n=!1);break;case"customerPhone":t.value==""&&($(`#${t.name}`).parent().addClass("has-error"),n=!1);break;case"deliveryAddress":t.value==""&&($(`#${t.name}`).parent().addClass("has-error"),n=!1)}}),n||Swal.fire(translateFunction("Vui lòng điền đầy đủ thông tin!"),translateFunction("Chúng tôi cần đầy đủ thông tin để có thể phục vụ quý khách một cách tốt nhất!"),"warning"),n?e.length>0?!0:!1:!1}if(i==2){f=$("#deliveryForm").serializeArray();let n={};if(u=!0,f.forEach(t=>{$(`#${t.name}`).parent().removeClass("has-error");switch(t.name){case"customerName":t.value==""?($(`#${t.name}`).parent().addClass("has-error"),u=!1):n.CustomerName=t.value;break;case"customerPhone":t.value==""?($(`#${t.name}`).parent().addClass("has-error"),u=!1):n.Phone=t.value;break;case"deliveryAddress":t.value==""?($(`#${t.name}`).parent().addClass("has-error"),u=!1):n.Address={Street:t.value,WardId:$("#deliveryWard").val(),DistrictId:$("#deliveryDistrict").val(),CityId:$("#deliveryCity").val()};break;case"Note":t.value!=""&&(n.Note=t.value)}}),u){let t=$("#customerPosition").val();n.ReceiverInfo=`Tên người nhận hàng ${n.CustomerName} là ${t} ở địa chỉ ${n.Address.Street} ()`;Swal.fire({icon:"success",title:translateFunction("Đang lên đơn hàng!"),html:translateFunction("Vui lòng đợi trong giây lát, tiến trình có thể mất vài giây"),showCancelButton:!1,showConfirmButton:!1,allowOutsideClick:!1,timerProgressBar:!0,onBeforeOpen:()=>{Swal.showLoading()}});console.log(n);$.ajax({url:"/"+getLang()+"/don-hang/createOrder",type:"POST",data:n,success:function(n){console.log(n);n.success?Swal.fire({title:translateFunction("Lên đơn hàng thành công"),html:translateFunction("Chúng tôi sẽ sớm liên lạc với quý khách. Cám ơn đã tin dùng sản phẩm của chúng tôi!"),icon:"success",onClose:()=>{setCart([]),window.location.href="/"}}):Swal.fire({icon:"error",title:n.message,html:`${n.errorMessage}`})},error:function(n){console.log(n);Swal.fire({icon:"error",title:`${n.name}`,html:`${n.message} <br> ${n.body?n.body:""}`})}})}else Swal.fire(translateFunction("Vui lòng điền đầy đủ thông tin người nhận hàng!"),translateFunction("Chúng tôi cần đầy đủ thông tin để có thể phục vụ quý khách một cách tốt nhất!"),"warning");return u}});$.ajax({method:"get",url:"/api/city/all",success:n=>{var t,i;if(n.success==!0){for(t=0;t<n.data.length;t++){let r=n.data[t];i=new Option(r.name,r.id);$(i).html(r.name);$("#deliveryCity").append(i)}$("#deliveryCity").val(1).trigger("change")}},error:n=>{console.log(n)}})});