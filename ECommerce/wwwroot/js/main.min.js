function getCookie(n){for(var t,r=n+"=",f=decodeURIComponent(document.cookie),u=f.split(";"),i=0;i<u.length;i++){for(t=u[i];t.charAt(0)==" ";)t=t.substring(1);if(t.indexOf(r)==0)return t.substring(r.length,t.length)}return""}function getLang(){try{let n=getCookie("lang");return n==""?"vi":n}catch(n){return"vi"}}function getCart(){try{let n=localStorage.getItem(nameCart);return JSON.parse(n)}catch(n){return[]}}function setCart(n){Array.isArray(n)&&localStorage.setItem(nameCart,JSON.stringify(n))}async function getProduct(n){let t=await fetch(`/getProduct?link=${n}`);return await t.json()}async function addProductToCart(n,t=1){var r=await getProduct(n),i;if(r.success){let n=getCart();(n==undefined||n==null)&&(n=[]);r.data.qty=1;let u=!1;for(i=0;i<n.length;i++)n[i].id==r.data.id&&(n[i].qty=n[i].qty!=undefined&&n[i].qty!=null?n[i].qty+t:t,u=!0);u||n.push(r.data);setCart(n);refreshCart();toastr.options={closeButton:!1,debug:!1,newestOnTop:!1,progressBar:!1,positionClass:"toast-top-right",preventDuplicates:!1,onclick:null,showDuration:"300",hideDuration:"1000",timeOut:"500",extendedTimeOut:"1000",showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"};toastr.info(translateFunction("Thêm thành công!"))}}function removeProductFromCart(n){let t=getCart();for(var i=0;i<t.length;i++)t[i].id==n&&t.splice(i,1);setCart(t);refreshCart()}function refreshCart(){let n=getCart(),i=[],r=0;for(var t=0;t<n.length;t++){let u=`<li class="product-info"><div class="p-left"><a onclick="removeProductFromCart(${n[t].id})" class="remove_link"></a><a href="/${getLang()}/san-pham?link=${n[t].url}.${n[t].id}"><img class="img-responsive" src="${n[t].product_Media[0].media.link}" alt="p10"></a></div><div class="p-right"><p class="p-name">${n[t].name}</p><p class="p-rice">${intToPrice(n[t].priceDiscount!=null?n[t].priceDiscount:n[t].price)}</p><p>${translateFunction("Số lượng")}: ${n[t].qty}</p></div></li>`;r+=(n[t].priceDiscount!=null?n[t].priceDiscount:n[t].price)*n[t].qty;i.push(u)}$("#ul-ls-cart-product").html(i.join(""));$("#title-cart-2").text(`${n.length} `+translateFunction("sản phẩm trong giỏ hàng"));$("#number-product-cart").text(n.length);$("#total-price").text(intToPrice(r));$("#title-cart").text(`${n.length} `+translateFunction("sản phẩm"))}function intToPrice(n){let i=getLang(),t="";switch(i){case"vi":t=new Intl.NumberFormat("vi",{style:"currency",currency:"VND"}).format(n);break;case"en":t=new Intl.NumberFormat("en",{style:"currency",currency:"USD"}).format(n);break;default:t=new Intl.NumberFormat("vi",{style:"currency",currency:"VND"}).format(n)}return t}function translateFunction(n){try{var i=getCookie("lang"),t={"Số lượng":{en:"Quantity"},"sản phẩm trong giỏ hàng":{en:"products in the cart"},"sản phẩm":{en:"product"},"Thêm thành công!":{en:"Add to cart success!"}}[n];return t==undefined||t==null?n:t[i]==undefined||t[i]==null?n:t[i]}catch(r){return console.log("translate fail : ",r),n}}let nameCart="GioHang";refreshCart();