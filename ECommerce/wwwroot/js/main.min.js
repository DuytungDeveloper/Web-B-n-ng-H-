function getCookie(n){for(var t,r=n+"=",f=decodeURIComponent(document.cookie),u=f.split(";"),i=0;i<u.length;i++){for(t=u[i];t.charAt(0)==" ";)t=t.substring(1);if(t.indexOf(r)==0)return t.substring(r.length,t.length)}return""}function getLang(){try{let n=getCookie("lang");return n==""?"vi":n}catch(n){return"vi"}}function getCart(){try{let n=localStorage.getItem(nameCart);return JSON.parse(n)}catch(n){return[]}}function setCart(n){Array.isArray(n)&&localStorage.setItem(nameCart,JSON.stringify(n))}async function getProduct(n){let t=await fetch(`/getProduct?link=${n}`);return await t.json()}async function addProductToCart(n,t=1){var r=await getProduct(n),i;if(r.success){let n=getCart();(n==undefined||n==null)&&(n=[]);r.data.qty=1;let u=!1;for(i=0;i<n.length;i++)n[i].id==r.data.id&&(n[i].qty=n[i].qty!=undefined&&n[i].qty!=null?n[i].qty+t:t,u=!0);u||n.push(r.data);setCart(n);refreshCart();toastr.options={closeButton:!1,debug:!1,newestOnTop:!1,progressBar:!1,positionClass:"toast-top-right",preventDuplicates:!1,onclick:null,showDuration:"300",hideDuration:"1000",timeOut:"500",extendedTimeOut:"1000",showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"};toastr.info(translateFunction("Thêm thành công!"))}}function removeProductFromCart(n){let t=getCart();for(var i=0;i<t.length;i++)t[i].id==n&&t.splice(i,1);setCart(t);refreshCart()}function removeProductFromCart_2(n){removeProductFromCart(n);location.href=location.pathname}function refreshCart(){let n=getCart(),i=[],r=0,u={AllProduct:[]};if(n!=null)for(var t=0;t<n.length;t++){let f=`<li class="product-info"><div class="p-left"><a onclick="removeProductFromCart(${n[t].id})" class="remove_link"></a><a href="/${getLang()}/san-pham?link=${n[t].url}.${n[t].id}"><img class="img-responsive" src="${n[t].product_Media[0].media.link}" alt="p10"></a></div><div class="p-right"><p class="p-name">${n[t].name}</p><p class="p-rice">${intToPrice(n[t].priceDiscount!=null?n[t].priceDiscount:n[t].price)}</p><p>${translateFunction("Số lượng")}: ${n[t].qty}</p></div></li>`;r+=(n[t].priceDiscount!=null?n[t].priceDiscount:n[t].price)*n[t].qty;i.push(f);u.AllProduct.push({Qty:n[t].qty,ProductId:n[t].id})}else n=[];$("#ul-ls-cart-product").html(i.join(""));$("#title-cart-2").text(`${n.length} `+translateFunction("sản phẩm trong giỏ hàng"));$("#number-product-cart").text(n.length);$("#total-price").text(intToPrice(r));$("#title-cart").text(`${n.length} `+translateFunction("sản phẩm"));$.ajax({url:`/${getLang()}/don-hang/saveorder`,type:"POST",data:u,success:function(n){console.log(n)}})}function intToPrice(n){let i=getLang(),t="";switch(i){case"vi":t=new Intl.NumberFormat("vi",{style:"currency",currency:"VND"}).format(n);break;case"en":t=new Intl.NumberFormat("en",{style:"currency",currency:"USD"}).format(n);break;default:t=new Intl.NumberFormat("vi",{style:"currency",currency:"VND"}).format(n)}return t}async function addReviewForProduct(n){n.preventDefault();let i=$("#id-product-review").val(),r=$("#comment-review-product").val(),u=parseFloat($("#review-point").val()).toString().replace(".",","),t={ProductId:i,Message:r,Point:u};console.log(t);$.ajax({url:`/${getLang()}/product/danh-gia-san-pham`,type:"POST",data:t,success:function(n){if(console.log(n),n.success){toastr.options={closeButton:!1,debug:!1,newestOnTop:!1,progressBar:!1,positionClass:"toast-top-right",preventDuplicates:!1,onclick:null,showDuration:"1000",hideDuration:"1000",timeOut:"5000",extendedTimeOut:"1000",showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"};toastr.info(translateFunction("Đăng đánh giá thành công!"));$("#form-danh-gia").trigger("reset");$("#rate-review-view").rateit("value",5);let t=`<div class="product-comments-block-tab">
                                        <div class="comment row">
                                            <div class="col-sm-3 author">
                                                <div class="grade">
                                                    <span>Grade</span>
                                                    <input type="range" value="${n.data.point}" step="0.1" id="rate-${n.data.id}">
                                                    <div class="rateit" id="append-rate-${n.data.id}" data-rateit-backingfld="#rate-${n.data.id}" data-rateit-resetable="false" data-rateit-ispreset="true"
                                                         data-rateit-min="0" data-rateit-max="5" data-rateit-readonly="true">
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="info-author">
                                                <span><strong>${n.data.applicationUser.userName}</strong></span>
                                                <em>${new Date(n.data.createDate)}</em>
                                            </div>
                                        </div>
                                        <div class="col-sm-9 commnet-dettail">
                                            ${n.data.message}
                                        </div>
                                    </div>
                                    <br />`;$("#ls-reviews").append(t);$(`#append-rate-${n.data.id}`).rateit()}else toastr.options={closeButton:!1,debug:!1,newestOnTop:!1,progressBar:!1,positionClass:"toast-top-right",preventDuplicates:!1,onclick:null,showDuration:"300",hideDuration:"1000",timeOut:"5000",extendedTimeOut:"1000",showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"},toastr.error(translateFunction(`Đăng đánh giá thất bại!`)+" "+n.errorMessage)}})}function searchProduct(n=0){let r=$("#limit-search").val(),u=$($("#order-search-desc i")[0]).attr("class").includes("desc"),f=$("#order-search").val(),t=n=>{let i=[],t=$(`input[name=${n}]`);for(let n=0;n<t.length;n++)$(t[n]).is(":checked")&&i.push(parseInt($(t[n]).val()));return i},e=t("MadeIns"),o=t("Straps"),s=t("Machines"),h=t("Bands"),c=t("ColorClockFaces"),l=t("Styles"),a=t("Waterproofs"),v=t("BrandProducts"),y=t("Category"),p=$("#search-text").val(),i={SearchString:p,BrandNameId:v,MachineId:s,BandId:h,StrapId:o,ColorClockFaceId:c,MadeInId:e,StyleId:l,WaterproofId:a,CategoryId:y,PriceFrom:parseFloat($("#price-from").val()),PriceTo:parseFloat($("#price-to").val()),Page:n,Limit:r,isDesc:u,orderBy:f};console.log(i);console.log($.param(i));console.log(location.pathname+"?"+$.param(i).replace(/%5B%5D/gi,""));location.href=location.pathname+"?"+$.param(i).replace(/%5B%5D/gi,"")}function changeSortType(){let n=$($("#order-search-desc i")[0]).attr("class").includes("desc");n?$("#order-search-desc").html(`<i class="fa fa-sort-alpha-asc" onclick="changeSortType()"></i>`):$("#order-search-desc").html(`<i class="fa fa-sort-alpha-desc" onclick="changeSortType()"></i>`)}function DateToString(n){var f=n.getHours(),t,i,e,r,u;return f=(f<10?"0":"")+f,t=n.getMinutes(),t=(t<10?"0":"")+t,i=n.getSeconds(),i=(i<10?"0":"")+i,e=n.getFullYear(),r=n.getMonth()+1,r=(r<10?"0":"")+r,u=n.getDate(),u=(u<10?"0":"")+u,u+"/"+r+"/"+e+" "+f+":"+t+":"+i}function translateFunction(n){try{var i=getCookie("lang"),t={"Số lượng":{en:"Quantity"},"sản phẩm trong giỏ hàng":{en:"products in the cart"},"sản phẩm":{en:"product"},"Thêm thành công!":{en:"Add to cart success!"},"Đăng đánh giá thất bại!":{en:"Post failed review!"},"Đăng đánh giá thành công!":{en:"Post a successful review!"},"Vui lòng điền đầy đủ thông tin người nhận hàng!":{en:"Please complete the consignee information!"},"Chúng tôi cần đầy đủ thông tin để có thể phục vụ quý khách một cách tốt nhất!":{en:"We need enough information to be able to serve you the best way!"},"Vui lòng điền đầy đủ thông tin!":{en:"Please fill out the form!"},"Đang lên đơn hàng!":{en:"Ordering!"},"Vui lòng đợi trong giây lát, tiến trình có thể mất vài giây":{en:"Please wait a moment, the process may take a few seconds"},"Lên đơn hàng thành công":{en:"Order successfully"},"Chúng tôi sẽ sớm liên lạc với quý khách. Cám ơn đã tin dùng sản phẩm của chúng tôi!":{en:"We will contact you shortly. Thank you for trusting our products!"}}[n];return t==undefined||t==null?n:t[i]==undefined||t[i]==null?n:t[i]}catch(r){return console.log("translate fail : ",r),n}}let nameCart="GioHang";refreshCart();